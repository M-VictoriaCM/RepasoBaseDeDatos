
# Ejercicio 1 
### Consultas con anidamiento (usando IN, NOT IN, EXISTS, NOT EXISTS):
***1.1.	Listar todas las películas que poseen entregas de películas de idioma inglés durante el año 2006. (P)***
```
SELECT p.*
FROM pelicula p
WHERE p.idioma ='ingles' AND
      p.codigo_pelicula IN(
      SELECT  rn.codigo_pelicula
      FROM renglon_entrega rn
      WHERE rn.nro_entrega IN(
        SELECT en.nro_entrega
        FROM entrega en
        WHERE EXTRACT(YEAR FROM en.fecha_entrega) = 2006)
    );
```
***1.2. Indicar la cantidad de películas que han sido entregadas en 2006 por un distribuidor nacional. Trate de resolverlo utilizando ensambles.(P)***
```
SELECT COUNT(*) AS cantidad_de_peliculas
FROM pelicula p
WHERE p.codigo_pelicula IN(
    SELECT re.codigo_pelicula
    FROM renglon_entrega re
    WHERE re.nro_entrega IN(
        SELECT en.nro_entrega
        FROM entrega en
        WHERE EXTRACT(YEAR FROM en.fecha_entrega) = 2006
        AND en.id_distribuidor IN(
            SELECT d.id_distribuidor
            FROM distribuidor d
            WHERE d.tipo  ='N'
            )
        )
    );
```
![image](https://github.com/M-VictoriaCM/RepasoBaseDeDatos/assets/70769530/7d25b599-1769-47ec-86ed-b6d3b6f8a230)

***1.3. Indicar los departamentos que no posean empleados cuya diferencia de sueldo máximo y mínimo (asociado a la tarea que realiza) no supere el 40% del sueldo máximo. (P) (Probar con 10% para que retorne valores)***
```
SELECT *
FROM departamento d
WHERE (id_distribuidor, id_departamento) NOT IN(
    SELECT id_distribuidor, id_departamento
    FROM empleado e
    JOIN tarea t
    ON (e.id_tarea = t.id_tarea)
    WHERE (t.sueldo_maximo - t.sueldo_minimo) <
          (SELECT 0.10 * MAX(sueldo_maximo)
            FROM tarea));
```
![image](https://github.com/M-VictoriaCM/RepasoBaseDeDatos/assets/70769530/f0ca61ac-531b-4e4e-ac75-66dc15eecbe3)

***1.4. Liste las películas que nunca han sido entregadas por un distribuidor nacional.(P)***
```
SELECT p.codigo_pelicula, p.titulo
FROM pelicula p
WHERE p.codigo_pelicula NOT IN(
    SELECT re.codigo_pelicula
    FROM renglon_entrega re
    WHERE re.nro_entrega IN(
        SELECT en.nro_entrega
        FROM entrega en
        WHERE en.id_distribuidor IN(
            SELECT d.id_distribuidor
            FROM distribuidor d
            WHERE d.tipo='N'
            )
        )
    );
```
![image](https://github.com/M-VictoriaCM/RepasoBaseDeDatos/assets/70769530/384cdbc3-61b6-4b83-a991-6fba3eb0c5cd)


***1.5. Determinar los jefes que poseen personal a cargo y cuyos departamentos (los del jefe) se encuentren en la Argentina.***
```
SELECT distinct j.*
FROM empleado e
JOIN empleado j
ON (e.id_jefe = j.id_empleado)
WHERE (j.id_distribuidor, j.id_departamento)
IN(
       SELECT d.id_distribuidor,d.id_departamento
       FROM departamento d
       WHERE d.id_ciudad IN(
           SELECT c.id_ciudad
           FROM ciudad c
           WHERE c.id_pais IN(
               SELECT p.id_pais
               FROM pais p
               WHERE p.nombre_pais = 'ARGENTINA'
               )
     )
   );
```
![image](https://github.com/M-VictoriaCM/RepasoBaseDeDatos/assets/70769530/7c864860-4b7b-4996-99f1-ecd723a44900)

***1.6. Liste el apellido y nombre de los empleados que pertenecen a aquellos departamentos de Argentina y donde el jefe de departamento posee una comisión de más del 10% de la que posee su empleado a cargo.***
```
SELECT e.*
FROM empleado e
JOIN empleado j ON e.id_jefe = j.id_empleado
JOIN departamento d ON e.id_departamento = d.id_departamento
WHERE d.id_ciudad IN (
    SELECT c.id_ciudad
    FROM ciudad c
    JOIN pais p ON c.id_pais = p.id_pais
    WHERE p.nombre_pais = 'ARGENTINA'
)
AND j.porc_comision > 0.10;
```
![image](https://github.com/M-VictoriaCM/RepasoBaseDeDatos/assets/70769530/26d13c01-fdfc-4016-aab8-eec7153c849c)

Consultas que involucran agrupamiento:
***1.7. Indicar la cantidad de películas entregadas a partir del 2010, por género.***
```
SELECT p.genero, COUNT(p.codigo_pelicula) AS cantidad_peliculas
FROM pelicula p
JOIN renglon_entrega re
ON(p.codigo_pelicula = re.codigo_pelicula)
JOIN entrega en
ON(re.nro_entrega = en.nro_entrega)
WHERE EXTRACT(YEAR FROM en.fecha_entrega) >= 2010
GROUP BY p.genero;
```
![image](https://github.com/M-VictoriaCM/RepasoBaseDeDatos/assets/70769530/72302ee8-e2ff-4dfa-a678-97de7453eb56)

***1.8. Realizar un resumen de entregas por día, indicando el video 
club al cual se le realizó la entrega y la cantidad entregada. Ordenar el resultado por fecha.***
```
SELECT v.razon_social, SUM(re.cantidad) AS cantidad, extract(DAY FROM en.fecha_entrega)
FROM renglon_entrega re
JOIN entrega en
ON(re.nro_entrega= en.nro_entrega)
JOIN video v
ON(en.id_video= v.id_video)
GROUP BY en.fecha_entrega, v.razon_social
ORDER BY en.fecha_entrega;
```
![image](https://github.com/M-VictoriaCM/RepasoBaseDeDatos/assets/70769530/7b3d588b-c583-48c0-a288-86aca89b0d45)

***1.9. Listar, para cada ciudad, el nombre de la ciudad y la cantidad de empleados mayores de edad que desempeñan tareas en departamentos de la misma y que posean al menos 30 empleados.***
```
```

